<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Distribución Exponencial</title>
    <style>
        /* Estilos del menú de navegación */
        .nav-container {
            background-color: #f5f5f5;
            border-radius: 10px;
            padding: 10px 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .nav-menu {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .nav-item {
            position: relative;
        }
        
        .nav-link {
            display: block;
            padding: 8px 16px;
            background-color: #4CAF50;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        
        .nav-link:hover {
            background-color: #45a049;
        }
        
        .nav-link.active {
            background-color: #3d8b40;
        }
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        .container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
        }
        button {
            padding: 8px 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
            gap: 2px;
        }
        .cell {
            width: 50px;
            height: 50px;
            border: 1px solid #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        .results-container {
            display: flex;
            gap: 20px;
            margin-top: 20px;
        }
        .chart-wrapper, .table-wrapper {
            flex: 1;
        }
        .chart {
            width: 100%;
            height: 300px;
        }
        .experiment {
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 20px;
        }
        .outcome {
            display: inline-block;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            color: white;
            text-align: center;
            line-height: 40px;
            margin: 5px;
            font-weight: bold;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
        }
        .probability-table {
            max-height: 300px;
            overflow-y: auto;
        }
        .sum-row {
            font-weight: bold;
            background-color: #f9f9f9;
        }
        .range-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .range-control input {
            width: 60px;
        }
        .color-legend {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }
        .equation {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            font-family: "Courier New", monospace;
            border-left: 4px solid #4CAF50;
        }
        .distribution-section {
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .distribution-charts {
            display: flex;
            gap: 20px;
            margin-top: 15px;
        }
        .distribution-chart {
            flex: 1;
            height: 250px;
        }
        .stats-container {
            display: flex;
            gap: 20px;
            margin-top: 15px;
        }
        .stat-box {
            flex: 1;
            background-color: #e9f7ef;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #4CAF50;
        }
        .mean-section {
            background-color: #e8f4f8;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #2196F3;
        }
        .histogram-bin {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }
        .bin-label {
            width: 80px;
        }
        .bin-bar {
            height: 20px;
            background-color: #4CAF50;
            margin-right: 10px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 5px;
            color: white;
            font-size: 12px;
        }
        .bin-count {
            width: 50px;
        }
    </style>
</head>
<body>
    <div class="container">
  <ul class="nav-menu">
    <!-- SECCIÓN VARIABLES CONTINUAS -->
    <li class="nav-section">Variables Aleatorias Continuas</li>
    <li class="nav-item"><a href="distribuionuniforme.html" class="nav-link">Uniforme</a></li>
    <li class="nav-item"><a href="distribucionGaussiana.html" class="nav-link">Gaussiana</a></li>
    <li class="nav-item"><a href="distribucionexponencial.html" class="nav-link">Exponencial</a></li>

    <!-- Separador visual (opcional) -->
    <li class="nav-divider"><hr></li>

    <!-- SECCIÓN VARIABLES DISCRETAS -->
    <li class="nav-section">Variables Aleatorias Discretas</li>
    <li class="nav-item"><a href="distrubucionBernoulii.html" class="nav-link">Bernoulli</a></li>
    <li class="nav-item"><a href="distribucionBinomial.html" class="nav-link">Binomial</a></li>
    <li class="nav-item"><a href="distribucionBinomialNegativa.html" class="nav-link active">Binomial Negativa</a></li>
    <li class="nav-item"><a href="distribucionPoisson.html" class="nav-link">Poisson</a></li>
    <li class="nav-item"><a href="distribucionGeometrica.html" class="nav-link">Geometrica</a></li>
    <li class="nav-item"><a href="distribucionHipergeometrica.html" class="nav-link">HiperGeometrica</a></li>

    <!-- Separador visual (opcional) -->
    <li class="nav-divider"><hr></li>

    <!-- OTRAS SECCIONES -->
    <li class="nav-section">Otros</li>
    <li class="nav-item"><a href="juegosAzarDaniel.html" class="nav-link">Juego pelotas</a></li>
    <li class="nav-item"><a href="distribucionGama.html" class="nav-link">Gama</a></li>
</ul>
        
        <h1>Distribución Exponencial</h1>
       
        <div class="experiment">
            <h2>Simulación de Distribución Exponencial</h2>
            <div class="range-control">
                <label for="lambdaValue">Tasa (λ):</label>
                <input type="number" id="lambdaValue" min="0.1" max="10" step="0.1" value="1">
                <label for="maxRange">Rango máximo:</label>
                <input type="number" id="maxRange" min="1" max="20" step="1" value="5">
                <label for="bins">Número de intervalos:</label>
                <input type="number" id="bins" min="5" max="30" step="1" value="10">
            </div>
            <p>La distribución exponencial modela el tiempo entre eventos en un proceso de Poisson con tasa λ</p>
        </div>
        
        <div class="mean-section">
            <h3>Propiedades de la Distribución Exponencial</h3>
            
            <div class="equation">
                <p><strong>Función de densidad de probabilidad (PDF):</strong></p>
                <p>f(x) = λe^(-λx) para x ≥ 0</p>
            </div>
            
            <div class="stats-container">
                <div class="stat-box">
                    <p><strong>Media (Valor esperado):</strong></p>
                    <p>E[X] = 1/λ</p>
                    <p>Media teórica: <span id="theoreticalMean">1.00</span></p>
                    <p>Media de la simulación: <span id="meanValue">0</span></p>
                </div>
                
                <div class="stat-box">
                    <p><strong>Varianza:</strong></p>
                    <p>Var(X) = 1/λ²</p>
                    <p>Varianza teórica: <span id="theoreticalVariance">1.00</span></p>
                    <p>Varianza de la simulación: <span id="varianceValue">0</span></p>
                </div>
                
                <div class="stat-box">
                    <p><strong>Desviación estándar:</strong></p>
                    <p>σ = 1/λ</p>
                    <p>Desviación teórica: <span id="theoreticalStdDev">1.00</span></p>
                    <p>Desviación de la simulación: <span id="stdDevValue">0</span></p>
                </div>
            </div>
            
            <div class="distribution-charts">
                <div class="distribution-chart">
                    <canvas id="pdfChart"></canvas>
                </div>
                <div class="distribution-chart">
                    <canvas id="cdfChart"></canvas>
                </div>
            </div>
        </div>
        
        <div class="controls">
            <button id="simulate1">Simular 1 vez</button>
            <button id="simulate10">Simular 10 veces</button>
            <button id="simulate100">Simular 100 veces</button>
            <button id="simulate1000">Simular 1000 veces</button>
            <button id="reset">Reiniciar</button>
            <div>
                <label for="speed">Velocidad:</label>
                <input type="range" id="speed" min="1" max="10" value="5">
            </div>
        </div>

        <div>
            <h3>Resultados</h3>
            <p>Total de simulaciones: <span id="total">0</span></p>
            <p>Tasa (λ): <span id="currentLambda">1</span></p>
            <p>Rango: [0, <span id="currentMaxRange">5</span>]</p>
            <p>Intervalos: <span id="currentBins">10</span></p>
            
            <div class="results-container">
                <div class="chart-wrapper">
                    <div class="chart">
                        <canvas id="histogramChart"></canvas>
                    </div>
                </div>
                
                <div class="table-wrapper">
                    <div class="probability-table">
                        <table id="resultsTable">
                            <thead>
                                <tr>
                                    <th>Intervalo</th>
                                    <th>Frecuencia</th>
                                    <th>Probabilidad</th>
                                    <th>Probabilidad teórica</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Las filas de la tabla se generarán dinámicamente -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <div>
            <h3>Histograma de Resultados</h3>
            <div id="textHistogram"></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Configuración inicial
        let lambda = 1;
        let maxRange = 5;
        let bins = 10;
        let binWidth = maxRange / bins;
        let histogram = new Array(bins).fill(0);
        let totalSimulations = 0;
        let allValues = [];
        let animationId = null;
        let simulationSpeed = 5;
        
        // Elementos del DOM
        const totalElement = document.getElementById('total');
        const lambdaValueElement = document.getElementById('lambdaValue');
        const maxRangeElement = document.getElementById('maxRange');
        const binsElement = document.getElementById('bins');
        const currentLambdaElement = document.getElementById('currentLambda');
        const currentMaxRangeElement = document.getElementById('currentMaxRange');
        const currentBinsElement = document.getElementById('currentBins');
        const speedControl = document.getElementById('speed');
        const resultsTableBody = document.querySelector('#resultsTable tbody');
        const histogramCtx = document.getElementById('histogramChart').getContext('2d');
        const theoreticalMeanElement = document.getElementById('theoreticalMean');
        const theoreticalVarianceElement = document.getElementById('theoreticalVariance');
        const theoreticalStdDevElement = document.getElementById('theoreticalStdDev');
        const meanValueElement = document.getElementById('meanValue');
        const varianceValueElement = document.getElementById('varianceValue');
        const stdDevValueElement = document.getElementById('stdDevValue');
        const textHistogramElement = document.getElementById('textHistogram');
        
        let histogramChart;
        let pdfChart;
        let cdfChart;

        // Inicializar la distribución
        function initializeDistribution() {
            lambda = parseFloat(lambdaValueElement.value);
            maxRange = parseFloat(maxRangeElement.value);
            bins = parseInt(binsElement.value);
            binWidth = maxRange / bins;
            
            // Actualizar la visualización de parámetros
            currentLambdaElement.textContent = lambda.toFixed(2);
            currentMaxRangeElement.textContent = maxRange.toFixed(2);
            currentBinsElement.textContent = bins;
            
            // Calcular propiedades teóricas
            const theoreticalMean = 1 / lambda;
            const theoreticalVariance = 1 / (lambda * lambda);
            const theoreticalStdDev = 1 / lambda;
            
            theoreticalMeanElement.textContent = theoreticalMean.toFixed(2);
            theoreticalVarianceElement.textContent = theoreticalVariance.toFixed(2);
            theoreticalStdDevElement.textContent = theoreticalStdDev.toFixed(2);
            
            // Reiniciar resultados
            histogram = new Array(bins).fill(0);
            allValues = [];
            totalSimulations = 0;
            
            // Actualizar la tabla de resultados
            updateResultsTable();
            
            // Inicializar o actualizar los gráficos
            initializeCharts();
            
            // Actualizar la UI
            updateUI();
        }

        // Inicializar los gráficos
        function initializeCharts() {
            const labels = [];
            for (let i = 0; i < bins; i++) {
                labels.push(`${(i * binWidth).toFixed(2)}-${((i + 1) * binWidth).toFixed(2)}`);
            }
            
            // Gráfico de histograma
            if (histogramChart) {
                histogramChart.destroy();
            }
            
            histogramChart = new Chart(histogramCtx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Frecuencia de resultados',
                        data: new Array(bins).fill(0),
                        backgroundColor: '#4CAF50',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true }
                    }
                }
            });
            
            // Gráfico PDF
            if (pdfChart) {
                pdfChart.destroy();
            }
            
            const pdfLabels = Array.from({length: 100}, (_, i) => i * maxRange / 100);
            const pdfData = pdfLabels.map(x => lambda * Math.exp(-lambda * x));
            
            const pdfCtx = document.getElementById('pdfChart').getContext('2d');
            pdfChart = new Chart(pdfCtx, {
                type: 'line',
                data: {
                    labels: pdfLabels.map(x => x.toFixed(2)),
                    datasets: [{
                        label: 'Función de Densidad de Probabilidad (PDF)',
                        data: pdfData,
                        borderColor: '#4CAF50',
                        backgroundColor: 'rgba(76, 175, 80, 0.1)',
                        fill: true,
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true }
                    }
                }
            });
            
            // Gráfico CDF
            if (cdfChart) {
                cdfChart.destroy();
            }
            
            const cdfLabels = Array.from({length: 100}, (_, i) => i * maxRange / 100);
            const cdfData = cdfLabels.map(x => 1 - Math.exp(-lambda * x));
            
            const cdfCtx = document.getElementById('cdfChart').getContext('2d');
            cdfChart = new Chart(cdfCtx, {
                type: 'line',
                data: {
                    labels: cdfLabels.map(x => x.toFixed(2)),
                    datasets: [{
                        label: 'Función de Distribución Acumulativa (CDF)',
                        data: cdfData,
                        borderColor: '#2196F3',
                        backgroundColor: 'rgba(33, 150, 243, 0.1)',
                        fill: true,
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { 
                            beginAtZero: true,
                            max: 1
                        }
                    }
                }
            });
        }

        // Actualizar la tabla de resultados
        function updateResultsTable() {
            resultsTableBody.innerHTML = '';
            
            let totalFreq = 0;
            let maxFreq = Math.max(...histogram, 1);
            
            // Generar histograma de texto
            let textHistogramHTML = '';
            
            for (let i = 0; i < bins; i++) {
                const binStart = i * binWidth;
                const binEnd = (i + 1) * binWidth;
                const freq = histogram[i] || 0;
                totalFreq += freq;
                
                // Calcular probabilidad teórica para el intervalo
                const theoreticalProb = Math.exp(-lambda * binStart) - Math.exp(-lambda * binEnd);
                
                // Fila de la tabla
                const row = document.createElement('tr');
                
                const binCell = document.createElement('td');
                binCell.textContent = `${binStart.toFixed(2)}-${binEnd.toFixed(2)}`;
                
                const freqCell = document.createElement('td');
                freqCell.textContent = freq;
                freqCell.id = `freq-${i}`;
                
                const probCell = document.createElement('td');
                probCell.textContent = '0%';
                probCell.id = `prob-${i}`;
                
                const theoreticalCell = document.createElement('td');
                theoreticalCell.textContent = (theoreticalProb * 100).toFixed(2) + '%';
                
                row.appendChild(binCell);
                row.appendChild(freqCell);
                row.appendChild(probCell);
                row.appendChild(theoreticalCell);
                
                resultsTableBody.appendChild(row);
                
                // Histograma de texto
                const barWidth = Math.max(1, Math.round((freq / maxFreq) * 50));
                textHistogramHTML += `
                    <div class="histogram-bin">
                        <div class="bin-label">${binStart.toFixed(2)}-${binEnd.toFixed(2)}</div>
                        <div class="bin-bar" style="width: ${barWidth}px">${freq}</div>
                        <div class="bin-count">${(freq / totalSimulations * 100 || 0).toFixed(1)}%</div>
                    </div>
                `;
            }
            
            textHistogramElement.innerHTML = textHistogramHTML;
            
            // Fila de totales
            const totalRow = document.createElement('tr');
            totalRow.className = 'sum-row';
            
            const totalLabelCell = document.createElement('td');
            totalLabelCell.textContent = 'Total';
            
            const totalFreqCell = document.createElement('td');
            totalFreqCell.textContent = totalFreq;
            totalFreqCell.id = 'totalFreq';
            
            const totalProbCell = document.createElement('td');
            totalProbCell.textContent = '100%';
            
           const totalTheoreticalCell = document.createElement('td');
totalTheoreticalCell.textContent = (Math.min(1, (Math.exp(-lambda * 0) - Math.exp(-lambda * maxRange))) * 100).toFixed(2) + '%';
            
            totalRow.appendChild(totalLabelCell);
            totalRow.appendChild(totalFreqCell);
            totalRow.appendChild(totalProbCell);
            totalRow.appendChild(totalTheoreticalCell);
            
            resultsTableBody.appendChild(totalRow);
        }

        // Simular un valor exponencial
        function simulate() {
            // Método de transformada inversa
            const u = Math.random();
            const value = -Math.log(1 - u) / lambda;
            allValues.push(value);
            totalSimulations++;
            
            // Determinar el intervalo del histograma
            let binIndex = Math.floor(value / binWidth);
            if (binIndex >= bins) binIndex = bins - 1;
            if (binIndex >= 0) histogram[binIndex]++;
            
            return value;
        }

        // Calcular la media de los resultados
        function calculateMean() {
            if (allValues.length === 0) return 0;
            const sum = allValues.reduce((a, b) => a + b, 0);
            return sum / allValues.length;
        }

        // Calcular la varianza de los resultados
        function calculateVariance(mean) {
            if (allValues.length < 2) return 0;
            const sumSquaredDiff = allValues.reduce((sum, x) => sum + Math.pow(x - mean, 2), 0);
            return sumSquaredDiff / allValues.length;
        }

        // Actualizar la UI
        function updateUI() {
            totalElement.textContent = totalSimulations;
            
            // Actualizar datos del gráfico de histograma
            histogramChart.data.datasets[0].data = histogram;
            histogramChart.update();
            
            // Actualizar tabla de resultados
            updateResultsTable();
            
            // Calcular y mostrar estadísticas
            const mean = calculateMean();
            const variance = calculateVariance(mean);
            const stdDev = Math.sqrt(variance);
            
            meanValueElement.textContent = mean.toFixed(4);
            varianceValueElement.textContent = variance.toFixed(4);
            stdDevValueElement.textContent = stdDev.toFixed(4);
        }

        // Simular múltiples valores
        function simulateMultiple(times, delay = 0) {
            if (animationId) {
                cancelAnimationFrame(animationId);
                clearTimeout(animationId);
            }

            let count = 0;
            let delayTime = (11 - simulationSpeed) * 20;

            function runSimulation() {
                if (count < times) {
                    simulate();
                    updateUI();
                    count++;

                    if (delay > 0) {
                        animationId = setTimeout(runSimulation, delayTime);
                    } else {
                        animationId = requestAnimationFrame(runSimulation);
                    }
                } else {
                    animationId = null;
                }
            }

            runSimulation();
        }

        // Event listeners
        document.getElementById('simulate1').addEventListener('click', () => {
            simulate();
            updateUI();
        });

        document.getElementById('simulate10').addEventListener('click', () => {
            simulateMultiple(10, 100);
        });

        document.getElementById('simulate100').addEventListener('click', () => {
            simulateMultiple(100, 10);
        });

        document.getElementById('simulate1000').addEventListener('click', () => {
            simulateMultiple(1000);
        });

        document.getElementById('reset').addEventListener('click', () => {
            initializeDistribution();
        });

        speedControl.addEventListener('input', () => {
            simulationSpeed = parseInt(speedControl.value);
        });

        lambdaValueElement.addEventListener('change', () => {
            initializeDistribution();
        });

        maxRangeElement.addEventListener('change', () => {
            initializeDistribution();
        });

        binsElement.addEventListener('change', () => {
            initializeDistribution();
        });

        // Inicializar al cargar la página
        initializeDistribution();
    </script>
</body>
</html>